(this["webpackJsonpblindtest-spotify"]=this["webpackJsonpblindtest-spotify"]||[]).push([[0],{13:function(e,t,n){},23:function(e,t,n){e.exports=n.p+"static/media/logo.e359ad39.svg"},24:function(e,t,n){e.exports=n(52)},29:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(22),s=n.n(c),o=(n(29),n(6)),i=n(7),l=n(9),u=n(8),h=n(1),m=n(10),d=(n(13),n(12)),f=n.n(d),k=(n(51),function(e){return r.a.createElement("button",{className:e.variant,onClick:e.onClick},e.children)}),p=n(23),v=n.n(p);function E(e){return Math.floor(Math.random()*e)}var b={NO_TOKEN_ENTERED:"NO_TOKEN_ENTERED",INVALID_TOKEN:"INVALID_TOKEN",VALID_TOKEN:"VALID_TOKEN"},g=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).state={tracksNumber:0,tracks:null,currentTrack:null,answersTracks:[],recordScore:0,currentScore:0,apiConnectionState:b.NO_TOKEN_ENTERED},e.checkAnswer=e.checkAnswer.bind(Object(h.a)(e)),e.selectNextTrack=e.selectNextTrack.bind(Object(h.a)(e)),e.switchTrack=e.switchTrack.bind(Object(h.a)(e)),e.renderContent=e.renderContent.bind(Object(h.a)(e)),e.fetchTracks=e.fetchTracks.bind(Object(h.a)(e)),e}return Object(m.a)(t,e),Object(i.a)(t,[{key:"fetchTracks",value:function(e){var t=this;fetch("https://api.spotify.com/v1/me/tracks?limit=50",{method:"GET",headers:{Authorization:"Bearer "+e}}).then((function(e){if(401===e.status)throw console.log("your Spotify API token has expired, please get another one"),new Error(e);return e})).then((function(e){return e.json()})).then((function(e){var n=e.items.length,a=e.items[E(n)];t.setState({tracksNumber:n,tracks:e.items,currentTrack:a,answersTracks:t.generateAnswerTracks(e.items,a),apiConnectionState:b.VALID_TOKEN})})).catch((function(){t.setState({apiConnectionState:b.INVALID_TOKEN})}))}},{key:"generateAnswerTracks",value:function(e,t){return function(e){for(var t=e.length;t>0;){var n=E(t),a=e[--t];e[t]=e[n],e[n]=a}return e}([t,e[E(e.length)],e[E(e.length)]])}},{key:"checkAnswer",value:function(e){var t=this;e.track.id===this.state.currentTrack.track.id?swal("Bravo !","Tu as trouv\xe9 la bonne chanson! ;)","success").then((function(){t.selectNextTrack();var e=t.state.currentScore+1;t.setState({currentScore:e})})):swal("Oups !","Ce n'est pas la bonne chanson!","error").then((function(){t.setState({currentScore:0,recordScore:t.state.currentScore>t.state.recordScore?t.state.currentScore:t.state.recordScore})}))}},{key:"selectNextTrack",value:function(){var e=this.state.tracks[E(this.state.tracksNumber)];this.setState({currentTrack:e,answersTracks:this.generateAnswerTracks(this.state.tracks,e)})}},{key:"switchTrack",value:function(){this.setState({currentScore:0}),this.selectNextTrack()}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement("img",{src:v.a,className:"App-logo",alt:"logo"}),r.a.createElement(T,{onFormSubmit:this.fetchTracks})),this.renderContent())}},{key:"renderContent",value:function(){var e=this;switch(this.state.apiConnectionState){case b.NO_TOKEN_ENTERED:return r.a.createElement("div",null,"Enter an Api token to start playing! \ud83d\ude0a (get one ",r.a.createElement("a",{target:"_blank",href:"https://developer.spotify.com/console/get-current-user-saved-tracks/?market=&limit=&offset="},"here"),")");case b.INVALID_TOKEN:return r.a.createElement("div",null,"Uh oh, seems like your token is invalid! \ud83d\ude15 Your token might have expired. Please generate one again!");case b.VALID_TOKEN:return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"App-images"},r.a.createElement(N,{track:this.state.currentTrack}),r.a.createElement(f.a,{url:this.state.currentTrack.track.preview_url,playStatus:f.a.status.PLAYING})),r.a.createElement("div",{className:"Scores-container"},r.a.createElement("div",null,r.a.createElement("span",{className:"Score-label"},"Score -")," ",this.state.currentScore),r.a.createElement("div",null,r.a.createElement("span",{className:"Score-label"},"Record -")," ",this.state.recordScore)),r.a.createElement("div",{className:"App-buttons"},this.state.answersTracks.map((function(t){return r.a.createElement(k,{variant:"primary",onClick:function(){return e.checkAnswer(t)}},t.track.name)}))),r.a.createElement("div",{className:"App-buttons"},r.a.createElement(k,{variant:"secondary",onClick:this.switchTrack},"Switch track!")));default:return}}}]),t}(a.Component),N=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.track.track.album.images[0].url;return r.a.createElement("div",null,r.a.createElement("img",{src:e,style:{width:300,height:300}}))}}]),t}(a.Component),T=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={value:""},n.handleChange=n.handleChange.bind(Object(h.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(h.a)(n)),n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){this.setState({value:e.target.value})}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.onFormSubmit(this.state.value)}},{key:"render",value:function(){return r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"Form-field"},r.a.createElement("span",{className:"Form-label"},"Enter your API token"),r.a.createElement("input",{className:"Form-input",type:"text",onChange:this.handleChange,value:this.state.value}),r.a.createElement(k,{variant:"primary",type:"submit"},"Fetch tracks")))}}]),t}(a.Component),w=g,O=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function S(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}s.a.render(r.a.createElement(w,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/blindtest-spotify",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/blindtest-spotify","/service-worker.js");O?function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):S(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e):S(e)}))}}()}},[[24,1,2]]]);
//# sourceMappingURL=main.a21bf6a6.chunk.js.map